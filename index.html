<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    
    <!-- ====== SEO & META ====== -->
    <meta name="description" content="Financial Masterplan PRO - Aplikasi perencanaan keuangan pribadi dengan timeline, dashboard, dan simulasi investasi">
    <meta name="keywords" content="keuangan, finansial, tabungan, investasi, budget, planning">
    <meta name="author" content="Financial Masterplan Team">
    
    <!-- ====== OPEN GRAPH / SOCIAL MEDIA ====== -->
    <meta property="og:title" content="Financial Masterplan PRO">
    <meta property="og:description" content="Plan your financial future with our advanced planning tools">
    <meta property="og:image" content="https://linzhijun87-ui.github.io/financial-app/icons/icon-512x512.png">
    <meta property="og:url" content="https://linzhijun87-ui.github.io/financial-app/">
    <meta property="og:type" content="website">
    
    <!-- ====== TWITTER CARD ====== -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Financial Masterplan PRO">
    <meta name="twitter:description" content="Advanced financial planning application">
    <meta name="twitter:image" content="https://linzhijun87-ui.github.io/financial-app/icons/icon-512x512.png">
    
    <!-- ====== PWA & THEME ====== -->
    <meta name="theme-color" content="#2c3e50">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="FinMaster">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- ====== MICROSOFT ====== -->
    <meta name="msapplication-TileColor" content="#2c3e50">
    
    <!-- ====== FAVICON & ICONS ====== -->
    <!-- PAKAI RELATIVE PATH -->
    <link rel="icon" href="favicon.ico">
    <link rel="icon" href="icons/icon-192x192.png" type="image/png" sizes="192x192">
    <link rel="icon" href="icons/icon-512x512.png" type="image/png" sizes="512x512">
    <link rel="apple-touch-icon" href="icons/icon-180x180.png">
    
    <!-- ====== PWA MANIFEST ====== -->
    <link rel="manifest" href="manifest.json">
    
    <!-- ====== SPLASH SCREENS ====== -->
    <link rel="apple-touch-startup-image" 
          href="splash/splash-1179x2556.png"
          media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" 
          href="splash/splash-1536x2048.png"
          media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    
    <!-- ====== STYLES ====== -->
    <link rel="stylesheet" href="style.css">
    
    <!-- ====== PRELOAD ====== -->
    <link rel="preload" href="style.css" as="style">
    <link rel="preload" href="script-fixed.js" as="script">
    
    <!-- ====== CHART.JS ====== -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js" crossorigin="anonymous" defer></script>
    
    <!-- ====== TITLE ====== -->
    <title>Financial Masterplan PRO | Perencanaan Keuangan Pribadi</title>
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header">
            <h1>ğŸ’° FINANCIAL MASTERPLAN PRO v1.0.3</h1>
            <div class="stats-bar">
                <div class="stat-item">ğŸ¯ Target: <span id="header-target">Rp 300 Juta</span></div>                
                <div class="stat-item" onclick="showTab('dashboard')">
                    ğŸ“… Sisa: <span id="days-left">1080</span> hari
                </div>
                <div class="stat-item" onclick="showTab('dashboard')">
                    ğŸ’µ Tabungan: <span id="total-saved">Rp 0</span>
                </div>
                <div class="stat-item">
                    ğŸ“Š Progress: <span id="overall-progress">0%</span>
                </div>
                <div class="notification-bell" onclick="showNotifications()">
                    ğŸ”” <span class="notification-badge" id="notification-count">0</span>
                </div>
            </div>
        </div>

        <!-- NAVIGASI -->
        <nav class="main-nav">
            <div class="nav-item active" onclick="showTab('dashboard')">ğŸ“Š Dashboard</div>
            <div class="nav-item" onclick="showTab('expenses')">ğŸ’¸ Pengeluaran</div>
            <div class="nav-item" onclick="showTab('income')">ğŸ’° Pendapatan</div>
            <div class="nav-item" onclick="showTab('checklists')">âœ… Checklist</div>
            <div class="nav-item" onclick="showTab('investments')">ğŸ“ˆ Simulasi</div>
            <div class="nav-item" onclick="showTab('settings')">âš™ï¸ Pengaturan</div>
        </nav>

        <!-- KONTEN -->
        <div class="content-area">
            <!-- DASHBOARD -->
            <div id="tab-dashboard" class="tab-content active">
                <h2>ğŸ“Š Dashboard Keuangan</h2>
                <div class="dashboard-grid">
                    <!-- PROGRESS -->
                    <div class="card">
                        <h3 class="card-title" id="dashboard-target-title">Progress Menuju Rp 300 Juta</h3>
                        <div class="progress-container">
                            <div style="height: 30px; background: #ecf0f1; border-radius: 15px; overflow: hidden;">
                                <div id="main-progress-bar" style="height: 100%; background: linear-gradient(90deg, #2ecc71, #1abc9c); width: 0%; border-radius: 15px;"></div>
                            </div>
                            <div style="text-align: center; margin-top: -25px; font-weight: bold; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.5);">
                                <span id="main-progress-text">0%</span>
                            </div>
                        </div>
                        <p><strong>Perlu ditabung:</strong> <span id="needed-per-month">8.333.333</span>/bulan</p>
                        <p><strong>Saldo bulan ini:</strong> <span id="actual-per-month" style="font-weight: bold;">Rp 0</span></p>
                    </div>

                    <!-- SALDO BULAN INI -->
                    <div class="card">
                        <h3 class="card-title">Saldo Bulan Ini</h3>
                        <div style="text-align: center; padding: 20px;">
                            <h2 id="current-month-balance" style="font-size: 2em; color: #27ae60;">Rp 0</h2>
                            <p style="color: #7f8c8d; margin: 15px 0;">
                                <small>Pendapatan - Pengeluaran bulan berjalan</small>
                            </p>
                            <div style="display: flex; gap: 10px; justify-content: center;">
                                <button class="btn btn-blue" onclick="showTab('income')">â• Tambah Pendapatan</button>
                                <button class="btn" onclick="showTab('expenses')">ğŸ“¤ Tambah Pengeluaran</button>
                            </div>
                        </div>
                    </div>
                    <!-- Card Pengeluaran & Charts -->
                    <div class="card">
                        <h3 class="card-title">ğŸ“Š Analisis Pengeluaran</h3>
                        
                        <!-- Tabs untuk pilihan chart -->
                        <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                            <button class="btn btn-small chart-tab active" data-chart="categories" onclick="switchChartTab('categories')">
                                ğŸ¥§ Per Kategori
                            </button>
                            <button class="btn btn-small chart-tab" data-chart="monthly" onclick="switchChartTab('monthly')">
                                ğŸ“ˆ Trend Bulanan
                            </button>
                            <button class="btn btn-small chart-tab" data-chart="progress" onclick="switchChartTab('progress')">
                                ğŸ¯ Progress Goal
                            </button>
                        </div>
                        
                        <!-- Container untuk semua chart -->
                        <div class="chart-container" style="height: 350px;">
                            <!-- Chart 1: Kategori Pengeluaran -->
                            <canvas id="expenseChart" style="display: block;"></canvas>
                            
                            <!-- Chart 2: Trend Bulanan -->
                            <canvas id="monthlyTrendChart" style="display: none;"></canvas>
                            
                            <!-- Chart 3: Progress Goal -->
                            <canvas id="progressChart" style="display: none;"></canvas>
                        </div>
                        
                        <!-- Summary Stats -->
                        <div id="chart-summary" style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                            <div id="categories-summary" class="chart-summary">
                                <!-- Akan diisi oleh JavaScript -->
                            </div>
                            <div id="monthly-summary" class="chart-summary" style="display: none;">
                                <!-- Akan diisi oleh JavaScript -->
                            </div>
                            <div id="progress-summary" class="chart-summary" style="display: none;">
                                <!-- Akan diisi oleh JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- NOTIFIKASI -->
                <div class="card">
                    <h3 class="card-title">Pengingat & Tips</h3>
                    <div class="alert alert-warning">
                        <strong>âš ï¸ Perhatian!</strong> Rencanakan anggaran untuk Imlek Februari 2026.
                    </div>
                    <div class="alert alert-info">
                        <strong>ğŸ’¡ Tips:</strong> Fokus menabung dulu sebelum mempertimbangkan kredit motor.
                    </div>
                    <div id="custom-reminders"></div>
                </div>
            </div>

            <!-- PENGELUARAN -->
            <div id="tab-expenses" class="tab-content">
                <h2>ğŸ’¸ Kelola Pengeluaran</h2>
                <div class="dashboard-grid">
                    <!-- FORM TAMBAH -->
                    <div class="card">
                        <h3 class="card-title">Tambah Pengeluaran Baru</h3>
                        <div class="form-group">
                            <label>Deskripsi:</label>
                            <input type="text" id="expense-desc" placeholder="Contoh: Angpao Imlek">
                        </div>
                        <div class="form-group">
                            <label>Jumlah (Rp):</label>
                            <input type="number" id="expense-amount" placeholder="200000">
                        </div>
                        <div class="form-group">
                            <label>Tanggal:</label>
                            <input type="date" id="expense-date">
                        </div>
                        <div class="form-group">
                            <label>Kategori:</label>
                            <div class="expense-categories">
                                <div class="category-btn active" data-category="keluarga" onclick="selectCategory(this, 'keluarga')">
                                    ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Keluarga
                                </div>
                                <div class="category-btn" data-category="kebutuhan" onclick="selectCategory(this, 'kebutuhan')">
                                    ğŸ›’ Kebutuhan
                                </div>
                                <div class="category-btn" data-category="hiburan" onclick="selectCategory(this, 'hiburan')">
                                    ğŸ‰ Hiburan
                                </div>
                                <div class="category-btn" data-category="investasi" onclick="selectCategory(this, 'investasi')">
                                    ğŸ“ˆ Investasi
                                </div>
                                <div class="category-btn" data-category="lainnya" onclick="selectCategory(this, 'lainnya')">
                                    ğŸ“¦ Lainnya
                                </div>
                            </div>
                            <input type="hidden" id="selected-category" value="keluarga">
                        </div>
                        <button class="btn" onclick="addExpense()" id="btn-add-expense">
                            â• Tambah Pengeluaran
                        </button>
                    </div>
                    
                    <div class="card">
                        <h3 class="card-title">
                            Daftar Pengeluaran
                            <select class="month-filter" id="expense-month-filter" onchange="filterExpensesByMonth()">
                                <option value="current">Bulan Ini</option>
                                <option value="all">Semua Bulan</option>
                                <option value="2025-12">Desember 2025</option>
                                <option value="2026-01">Januari 2026</option>
                                <option value="2026-02">Februari 2026</option>
                            </select>
                        </h3>
                        <div class="expense-list" id="expense-list-container">
                            <p style="text-align: center; color: #999; padding: 20px;">Belum ada pengeluaran.</p>
                        </div>
                        <p><strong>Total ditampilkan: <span id="expense-total-display">Rp 0</span></strong></p>
                    </div>
                </div>
            </div>

            <!-- PENDAPATAN -->
            <div id="tab-income" class="tab-content">
                <h2>ğŸ’° Kelola Pendapatan</h2>
                <div class="dashboard-grid">
                    <!-- FORM TAMBAH -->
                    <div class="card">
                        <h3 class="card-title">Tambah Pendapatan</h3>
                        <div class="form-group">
                            <label>Sumber:</label>
                            <select id="income-source">
                                <option value="gaji_utama">Gaji Utama</option>
                                <option value="freelance">Freelance/Side Job</option>
                                <option value="bonus">Bonus/THR</option>
                                <option value="investasi">Hasil Investasi</option>
                                <option value="lainnya">Lainnya</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Jumlah (Rp):</label>
                            <input type="number" id="income-amount" placeholder="11000000">
                        </div>
                        <div class="form-group">
                            <label>Tanggal:</label>
                            <input type="date" id="income-date">
                        </div>
                        <div class="form-group">
                            <label>Keterangan:</label>
                            <textarea id="income-notes" rows="2" placeholder="Contoh: Gaji Desember 2025"></textarea>
                        </div>
                        <button class="btn btn-blue" onclick="addIncome()" id="btn-add-income">
                            ğŸ’° Tambah Pendapatan
                        </button>
                    </div>

                    <!-- STATISTIK -->
                    <div class="card">
                        <h3 class="card-title">Statistik Pendapatan</h3>
                        <div class="chart-container">
                            <canvas id="incomeChart"></canvas>
                        </div>
                        <p><strong>Total bulan ini:</strong> <span id="monthly-income-total" style="color: #27ae60;">Rp 0</span></p>
                        <p><strong>Sumber terbesar:</strong> <span id="largest-income-source">-</span></p>
                    </div>

                    <!-- RIWAYAT -->
                    <div class="card">
                        <h3 class="card-title">
                            Riwayat Pendapatan
                            <select class="month-filter" id="income-month-filter" onchange="filterIncomeByMonth()">
                                <option value="current">Bulan Ini</option>
                                <option value="all">Semua Bulan</option>
                                <option value="2025-12">Desember 2025</option>
                                <option value="2026-01">Januari 2026</option>
                                <option value="2026-02">Februari 2026</option>
                            </select>
                        </h3>
                        <div class="expense-list" id="income-history-container">
                            <p style="text-align: center; color: #999; padding: 20px;">Belum ada pendapatan.</p>
                        </div>
                        <p><strong>Total ditampilkan: <span id="yearly-income-total">Rp 0</span></strong></p>
                    </div>
                </div>
            </div>

            <!-- CHECKLIST -->
            <div id="tab-checklists" class="tab-content">
                <h2>âœ… Checklist Persiapan</h2>
                <div class="card">
                    <h3 class="card-title">Checklist Keuangan</h3>
                    <div class="checklist-system" id="master-checklist"></div>
                    <button class="btn" onclick="addChecklistItem()">
                        â• Tambah Item Baru
                    </button>
                </div>
            </div>

            <!-- SIMULASI -->
            <div id="tab-investments" class="tab-content">
                <h2>ğŸ“ˆ Simulasi Investasi</h2>
                <div class="card">
                    <h3 class="card-title" id="simulation-target-title">Simulasi Mencapai Rp 300 Juta</h3>
                    <div class="slider-container">
                        <div class="form-group">
                            <label>Tabungan bulanan: <span id="saving-slider-value">Rp 500.000</span></label>
                            <input type="range" min="0" max="10000000" step="100000" value="500000" 
                                   class="what-if-slider" id="saving-slider" oninput="updateSimulation()">
                        </div>
                        <div class="form-group">
                            <label>Return investasi tahunan: <span id="return-slider-value">6%</span></label>
                            <input type="range" min="0" max="20" step="1" value="6" 
                                   class="what-if-slider" id="return-slider" oninput="updateSimulation()">
                        </div>
                    </div>
                    <div class="simulation-result">
                        <h4>ğŸ“Š Hasil Proyeksi 3 Tahun:</h4>
                        <p><strong>Total terkumpul:</strong> <span id="simulated-total">Rp 0</span></p>
                        <p><strong>Status target:</strong> <span id="target-status" style="font-weight: bold; color: #e74c3c;">BELUM TERCAPAI</span></p>
                        <p><strong>Kekurangan/kelebihan:</strong> <span id="gap-amount">Rp 0</span></p>
                    </div>
                </div>
            </div>

            <!-- PENGATURAN -->
            <div id="tab-settings" class="tab-content">
                <h2>âš™ï¸ Pengaturan</h2>
                <!-- âš™ï¸ PENGATURAN TARGET -->
                <div class="card">
                    <h3 class="card-title">ğŸ¯ Target Finansial</h3>
                    
                    <!-- TARGET AMOUNT -->
                    <div class="form-group">
                        <label>ğŸ’° Target Dana:</label>
                        <div class="input-with-preset">
                            <input type="number" id="target-amount-input" value="300" min="1" 
                                placeholder="Contoh: 300">
                            <span class="input-suffix">Juta Rupiah</span>
                        </div>
                        <div class="preset-buttons">
                            <button class="btn-preset" onclick="setTargetPreset(100)">100 Jt</button>
                            <button class="btn-preset" onclick="setTargetPreset(300)">300 Jt</button>
                            <button class="btn-preset" onclick="setTargetPreset(500)">500 Jt</button>
                            <button class="btn-preset" onclick="setTargetPreset(1000)">1 M</button>
                        </div>
                    </div>
                    
                    <!-- SAVE BUTTON -->
                    <button class="btn btn-green" onclick="safeSaveSettings()" style="width: 100%;">
                        ğŸ’¾ Simpan Target
                    </button>
                </div>

                <!-- â° TIMELINE MANAGEMENT -->
                <div class="card">
                    <h3 class="card-title">ğŸ“… Kelola Timeline</h3>
                    
                    <!-- CURRENT TIMELINE DISPLAY -->
                    <div class="timeline-summary">
                        <div class="timeline-stat">
                            <div class="stat-label">Mulai</div>
                            <div class="stat-value" id="display-start-date">-</div>
                        </div>
                        <div class="timeline-arrow">â†’</div>
                        <div class="timeline-stat">
                            <div class="stat-label">Target</div>
                            <div class="stat-value" id="display-end-date">-</div>
                        </div>
                        <div class="timeline-stat">
                            <div class="stat-label">Sisa</div>
                            <div class="stat-value" id="display-days-left">-</div>
                            <div class="stat-sub">hari</div>
                        </div>
                        <div class="timeline-stat">
                            <div class="stat-label">Progress</div>
                            <div class="stat-value" id="display-timeline-progress">0%</div>
                        </div>
                    </div>
                    
                    <!-- TIMELINE EDITOR -->
                    <div class="timeline-editor">
                        <div class="form-row">
                            <div class="form-group">
                                <label>ğŸ“… Tanggal Mulai</label>
                                <input type="date" id="start-date" class="date-input">
                            </div>
                            <div class="form-group">
                                <label>ğŸ¯ Tanggal Target</label>
                                <input type="date" id="end-date" class="date-input">
                            </div>
                        </div>
                        
                        <!-- QUICK SETTINGS -->
                        <div class="quick-timeline">
                            <label>âš¡ Set Cepat:</label>
                            <div class="quick-buttons">
                                <button class="btn-quick" onclick="setQuickTimeline(1)">1 Tahun</button>
                                <button class="btn-quick" onclick="setQuickTimeline(2)">2 Tahun</button>
                                <button class="btn-quick" onclick="setQuickTimeline(3)">3 Tahun</button>
                                <button class="btn-quick" onclick="setQuickTimeline(5)">5 Tahun</button>
                                <button class="btn-quick" onclick="setQuickTimelineFromToday()">
                                    Dari Hari Ini
                                </button>
                            </div>
                        </div>
                        
                        <!-- VALIDATION & PREVIEW -->
                        <div id="timeline-validation" class="validation-message"></div>
                        
                        <div class="timeline-preview">
                            <h4>ğŸ“Š Timeline Preview</h4>
                            <div class="preview-grid">
                                <div class="preview-item">
                                    <span class="preview-label">Total Durasi:</span>
                                    <span class="preview-value" id="preview-duration">-</span>
                                </div>
                                <div class="preview-item">
                                    <span class="preview-label">Sisa Hari:</span>
                                    <span class="preview-value" id="preview-days-left">-</span>
                                </div>
                                <div class="preview-item">
                                    <span class="preview-label">Progress:</span>
                                    <span class="preview-value" id="preview-progress">-</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ACTION BUTTONS -->
                        <div class="action-buttons">
                            <button class="btn btn-blue" onclick="safeSaveTimeline()">
                                ğŸ’¾ Simpan Timeline
                            </button>
                            <button class="btn" onclick="resetToDefaultTimeline()">
                                ğŸ”„ Default
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ğŸ“± MULTI-DEVICE & BACKUP -->
                <div class="card">
                    <h3 class="card-title">ğŸ”„ Backup & Sync</h3>
                    
                    <div class="backup-section">
                        <div class="backup-option">
                            <h4>ğŸ“¤ Export Data</h4>
                            <p>Simpan semua data ke file JSON</p>
                            <button class="btn" onclick="exportData()">
                                â¬‡ï¸ Download Backup
                            </button>
                        </div>
                        
                        <div class="backup-option">
                            <h4>ğŸ“¥ Import Data</h4>
                            <p>Restore data dari file backup</p>
                            <input type="file" id="import-file" accept=".json" 
                                style="margin: 10px 0;">
                            <button class="btn" onclick="importData()">
                                â¬†ï¸ Upload & Restore
                            </button>
                        </div>
                        
                        <div class="backup-option">
                            <h4>ğŸ“± QR untuk HP</h4>
                            <p>Scan untuk buka app di mobile</p>
                            <input type="text" id="qrText" 
                                placeholder="URL GitHub Pages" 
                                class="qr-input">
                            <button class="btn" onclick="generateQRCode()">
                                ğŸ“² Generate QR
                            </button>
                            <div id="qrCode" class="qr-container"></div>
                        </div>
                    </div>
                </div>

                <!-- ğŸ—‘ï¸ DATA MANAGEMENT -->
                <div class="card card-warning">
                    <h3 class="card-title">âš ï¸ Manajemen Data</h3>
                    
                    <div class="warning-message">
                        <p><strong>Perhatian!</strong> Aksi ini tidak dapat dibatalkan.</p>
                    </div>
                    
                    <div class="danger-actions">
                        <button class="btn btn-red" onclick="resetAllData()">
                            ğŸ—‘ï¸ Reset Semua Data
                        </button>
                        <button class="btn" onclick="clearLocalStorage()" 
                                style="margin-left: 10px;">
                            ğŸ§¹ Clear Cache
                        </button>
                    </div>
                    
                    <div class="data-stats">
                        <p><strong>ğŸ“Š Statistik Data:</strong></p>
                        <p>Pendapatan: <span id="data-count-income">0</span> transaksi</p>
                        <p>Pengeluaran: <span id="data-count-expense">0</span> transaksi</p>
                        <p>Terakhir backup: <span id="last-backup-time">-</span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL NOTIFIKASI -->
    <div id="notification-modal" class="modal">
        <div class="modal-content">
            <h3>ğŸ”” Notifikasi</h3>
            <div id="notification-list">
                <p>Belum ada notifikasi.</p>
            </div>
            <button class="btn" onclick="closeModal()">Tutup</button>
        </div>
    </div>
    <script src="script-fixed.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <!-- Dark mode detection -->
<script>
    // Detect dark mode
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.documentElement.classList.add('dark-mode');
    }
</script>

<!-- Splash screen for iOS -->
<link rel="apple-touch-startup-image" href="icons/apple-splash-2048-2732.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
</body>
</html>